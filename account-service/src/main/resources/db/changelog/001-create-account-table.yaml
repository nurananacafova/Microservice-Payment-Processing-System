databaseChangeLog:
  - changeSet:
      id: 001-create-account-tables
      author: developer
      changes:
        - createTable:
            tableName: accounts
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: account_number
                  type: VARCHAR(50)
                  constraints:
                    unique: true
                    nullable: false
              - column:
                  name: user_id
                  type: BIGINT
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: TIMESTAMP
        - createTable:
            tableName: balances
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: currency
                  type: VARCHAR(3)
                  constraints:
                    nullable: false
              - column:
                  name: amount
                  type: DECIMAL(19,4)
                  constraints:
                    nullable: false
              - column:
                  name: account_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    foreignKeyName: fk_balances_account
                    references: accounts(id)
        - createTable:
            tableName: transaction_records
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: transaction_id
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
              - column:
                  name: account_number
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
              - column:
                  name: currency
                  type: VARCHAR(3)
              - column:
                  name: amount
                  type: DECIMAL(19,4)
              - column:
                  name: created_at
                  type: TIMESTAMP
        - addUniqueConstraint:
            tableName: transaction_records
            columnNames: transaction_id
            constraintName: uk_transaction_id
        - createIndex:
            tableName: accounts
            indexName: idx_account_number
            columns:
              - column:
                  name: account_number
        - createIndex:
            tableName: accounts
            indexName: idx_user_id
            columns:
              - column:
                  name: user_id
        - createIndex:
            tableName: balances
            indexName: idx_account_currency
            columns:
              - column:
                  name: account_id
              - column:
                  name: currency

#databaseChangeLog:
#  - changeSet:
#      id: 001-create-account-tables
#      author: developer
#      changes:
#        - createTable:
#            tableName: accounts
#            columns:
#              - column:
#                  name: id
#                  type: BIGINT
#                  autoIncrement: true
#                  constraints:
#                    primaryKey: true
#                    nullable: false
#              - column:
#                  name: account_number
#                  type: VARCHAR(50)
#                  constraints:
#                    unique: true
#                    nullable: false
#              - column:
#                  name: user_id
#                  type: BIGINT
#                  constraints:
#                    nullable: false
#              - column:
#                  name: created_at
#                  type: TIMESTAMP
#        - createTable:
#            tableName: balances
#            columns:
#              - column:
#                  name: id
#                  type: BIGINT
#                  autoIncrement: true
#                  constraints:
#                    primaryKey: true
#                    nullable: false
#              - column:
#                  name: currency
#                  type: VARCHAR(3)
#                  constraints:
#                    nullable: false
#              - column:
#                  name: amount
#                  type: DECIMAL(15,2)
#                  constraints:
#                    nullable: false
#              - column:
#                  name: account_id
#                  type: BIGINT
#                  constraints:
#                    nullable: false
#                    foreignKeyName: fk_balances_account
#                    references: accounts(id)
#        - createIndex:
#            tableName: accounts
#            indexName: idx_account_number
#            columns:
#              - column:
#                  name: account_number
#        - createIndex:
#            tableName: accounts
#            indexName: idx_user_id
#            columns:
#              - column:
#                  name: user_id
#        - createIndex:
#            tableName: balances
#            indexName: idx_account_currency
#            columns:
#              - column:
#                  name: account_id
#              - column:
#                  name: currency
##databaseChangeLog:
##  - changeSet:
##      id: 1
##      author: NuranaN
##      changes:
##        - createTable:
##            tableName: accounts
##            columns:
##              - column:
##                  name: id
##                  type: BIGINT
##                  autoIncrement: true
##                  constraints:
##                    primaryKey: true
##                    nullable: false
##              - column:
##                  name: user_id
##                  type: VARCHAR(255) # Basit kimliklendirme için.
##                  constraints:
##                    nullable: false
##                    unique: true
##              - column:
##                  name: created_at
##                  type: TIMESTAMP WITH TIME ZONE
##                  defaultValueComputed: now()
##                  constraints:
##                    nullable: false
##        - createTable:
##            tableName: balances
##            columns:
##              - column:
##                  name: id
##                  type: BIGINT
##                  autoIncrement: true
##                  constraints:
##                    primaryKey: true
##                    nullable: false
##              - column:
##                  name: account_id
##                  type: BIGINT
##                  constraints:
##                    nullable: false
##                    foreignKeyName: fk_balance_account
##                    references: accounts(id)
##              - column:
##                  name: currency
##                  type: VARCHAR(3) # EUR, USD, AZN
##                  constraints:
##                    nullable: false
##              - column:
##                  name: amount
##                  type: NUMERIC(19, 4) # Hassas para hesaplamaları için
##                  constraints:
##                    nullable: false
##              - column:
##                  name: version
##                  type: INTEGER # Eşzamanlılık için Optimistic Locking
##                  defaultValueNumeric: 0
##                  constraints:
##                    nullable: false
##        - addUniqueConstraint:
##            columnNames: account_id, currency
##            constraintName: uk_account_currency
##            tableName: balances